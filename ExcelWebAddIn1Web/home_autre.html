<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>test</title>
    <script src="MesFunctions.js" type="text/javascript"></script>
    <script src="Scripts/jquery-3.6.0.js" type="text/javascript"></script>
    <link rel="icon" href="https://quarksup.com/wp-content/uploads/2020/10/favicon-16X16.png" type="image/png" />
    <link rel="shortcut icon" href="https://quarksup.com/wp-content/uploads/2020/10/favicon-16X16.png" type="image/png" />
    <link rel="apple-touch-icon" href="https://quarksup.com/wp-content/uploads/2020/09/favicon-60X60-1.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://quarksup.com/wp-content/uploads/2020/09/favicon-76X76-1.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://quarksup.com/wp-content/uploads/2020/09/favicon-120X120-1.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://quarksup.com/wp-content/uploads/2020/09/favicon-152X152-1.png">
    
    <script src="Scripts/boostrap/bootstrap.min.js"></script>
    <link href="Content/boostrap/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
   


    <form>
        <div class="form-group">
            <label for="inputEmail">Email</label>
            <input type="email" class="form-control" id="inputEmail" placeholder="Email">
        </div>
        <div class="form-group">
            <label for="inputPassword">Password</label>
            <input type="password" class="form-control" id="inputPassword" placeholder="Password">
        </div>

        <button id="getToken" type="button" class="btn btn-primary">Connection</button>
    </form><br>
    <textarea id="response">

    </textarea>
    <!--https://login.quarksup.net/adfs/ls/IdpInitiatedSignon.aspx-->
    <iframe id="iframeId" width="100%" height="35%" src="" frameborder="0" allowfullscreen></iframe>
    <script>
        $('#getToken').on('click', function () {
            var username = '2ab19572 - ce85 - 4b86 - a257 - 9a8b6d6350c6';
            var password = 'jLuLnaQSmpfiXfOoKHI - I8Rmg5DYjLd4K1q0o3uI';

            username = "TestExcelAddIn";
            password = "addINpoc2022;";

            $.ajax
                ({
                    type: "post",
                    url: "https://login.quarksup.net/adfs/oauth2/token",
                    //url: "https://api.publicapis.org/entries",
                    //url: "https://login.quarksup.net/adfs/oauth2/authorize",
                    //url: "https://login.quarksup.net/adfs",
                    //url: "https://service-preview-staging.quarksup.net/api/v2/organization/metadata/SessionRegistrationStatus?locale=fr-FR",
                    dataType: 'html',
                    //async: false,
                    //data: '{"username": "' + username + '", "password" : "' + password + '"}',
                    //dataType: "jsonp",
                    //accept: 'application/json',
                    headers: {
                        // "Access-Control-Allow-Origin:": "*"

                    },
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader("Authorization", "Basic " + btoa(username + ":" + password));
                    },
                    success: function (response) {
                        $('#response').val(response);
                        document.getElementById('iframeId').src = "<!---->" + response;
                        document.getElementById('response').text = "<!---->" + response;
                        alert('click');
                    },
                    error: function (response, errorThrown) {
                        document.getElementById('response').text = "<!---->" + response;
                        alert(errorThrown + " " + response);
                    }
                });
        });
    </script>

</body>
</html>